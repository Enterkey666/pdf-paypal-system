# PDF一括処理 & PayPal決済リンク発行システム

## 概要

PDFファイルをアップロードして、請求金額と請求先情報を自動抽出し、PayPal決済用のリンクを自動生成するシステムです。複数のPDFファイルをバッチ処理することができます。ゲスト決済対応のPayPalリンクを生成し、請求業務を効率化します。

## 主な機能

- PDFファイルのアップロード（ドラッグ＆ドロップ対応）
- 請求金額の自動抽出（自動抽出できない場合は手動入力可能）
- 請求先名の自動抽出（”〇〇様”の形式で表示）
- PayPal決済リンクの自動生成（アカウント不要のゲスト決済対応）
- 複数ファイルの一括処理
- PayPal APIの設定管理機能
- 設定のインポート/エクスポート機能
- 処理履歴の管理と表示

## 特徴

- **AI OCR機能**: Google Cloud Vision API、Microsoft Azure Form Recognizer、Tesseract OCRの選択が可能
- **高精度な請求金額抽出**: 様々な形式の請求書・領収書から金額を正確に抽出
- **顧客名の自動検出**: 文書左上を優先的に検索し、請求先の名前を抽出
- **ゲスト決済対応**: PayPalアカウントがなくてもクレジットカードで支払い可能
- **簡単な設定画面**: PayPal API認証情報の設定や接続テストがブラウザから可能
- **処理状況の可視化**: ファイル処理中のプログレスバー表示
- **本番環境表示**: 本番環境での運用時に明確な表示で警告

## 技術仕様

- **バックエンド**: Python + Flask
- **フロントエンド**: HTML/CSS/JavaScript + Bootstrap 5
- **PDF処理**:
  - pdfplumber (テキスト抽出、表分析)
  - PyPDF2 (互換性向上)
  - pdf2image + Tesseract OCR (画像ベースのPDF対応)
  - pdfminer.six (複雑なエンコーディングのPDF対応)
- **AI OCR**: Google Cloud Vision API、Microsoft Azure Form Recognizer、Tesseract OCR
- **決済API**: PayPal API (v2)
- **設定管理**: JSON形式での保存・管理

## 使い方

### 簡単起動方法（推奨）

1. ZIPファイルを展開後、`run_app.bat`をダブルクリック
2. 初回起動時は自動セットアップが行われます
   - Pythonがインストールされていない場合は自動インストーラーが起動
   - 必要なライブラリの自動インストール
   - デスクトップにショートカットを作成可能
3. ブラウザが自動的に開き、アプリケーションにアクセスできます

### 手動起動方法

1. ローカルサーバーを起動: `python app.py`
2. ブラウザでアクセス: `http://localhost:5000`
3. 設定ページでPayPal API情報とOCR設定を行う
4. ホームページでPDFファイルをアップロードして処理
5. 生成された決済リンクを利用して支払いを受け付け

---
